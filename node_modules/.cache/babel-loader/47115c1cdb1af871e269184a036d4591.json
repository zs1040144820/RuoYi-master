{"remainingRequest":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js!D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\src\\views\\vuln\\scan\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\src\\views\\vuln\\scan\\index.vue","mtime":1686732510000},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\babel.config.js","mtime":1686732510000},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1687240770813},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1687240784151},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1687240770813},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1687240772826}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQgPSByZXF1aXJlKCJEOi9Tb2Z0d2FyZURhdGEvSW50ZWxsaUogSURFQURhdGEvUnVvWWkvcnVveWktbWFzdGVyL3J1b3lpLW1hc3Rlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9pbnRlcm9wUmVxdWlyZURlZmF1bHQuanMiKS5kZWZhdWx0OwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7CiAgdmFsdWU6IHRydWUKfSk7CmV4cG9ydHMuZGVmYXVsdCA9IHZvaWQgMDsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUuanMiKTsKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4uanMiKTsKdmFyIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQocmVxdWlyZSgiRDovU29mdHdhcmVEYXRhL0ludGVsbGlKIElERUFEYXRhL1J1b1lpL3J1b3lpLW1hc3Rlci9ydW95aS1tYXN0ZXIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyIpKTsKdmFyIF9zY2FuID0gcmVxdWlyZSgiQC9hcGkvdnVsbi9zY2FuIik7CnZhciBfYXV0aCA9IHJlcXVpcmUoIkAvdXRpbHMvYXV0aCIpOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwp2YXIgX2RlZmF1bHQgPSB7CiAgbmFtZTogIlNjYW4iLAogIGNvbXBvbmVudHM6IHt9LAogIHByb3BzOiBbXSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZm9ybURhdGE6IHsKICAgICAgICB1dWlkOiAiIiwKICAgICAgICBzY3JpcHRTZWxlY3Q6IFtdLAogICAgICAgIGNoZWNrZWQ6IHRydWUsCiAgICAgICAgc3JjSVA6ICIiLAogICAgICAgIGRlc0lQOiAiIiwKICAgICAgICB1c2VGaWxlOiBmYWxzZSwKICAgICAgICBhZGRyRmlsZU5hbWU6ICIiLAogICAgICAgIHN0YXJ0UG9ydDogIiIsCiAgICAgICAgZW5kUG9ydDogIiIsCiAgICAgICAgZGF0YWJhc2VTd2l0Y2g6IGZhbHNlLAogICAgICAgIG9zU3dpdGNoOiBmYWxzZQogICAgICB9LAogICAgICBwb3J0U3dpdGNoOiBmYWxzZSwKICAgICAgLy8g5LiK5Lyg5Y+C5pWwCiAgICAgIHVwbG9hZDogewogICAgICAgIC8vIOaYr+WQpuemgeeUqOS4iuS8oAogICAgICAgIGlzVXBsb2FkaW5nOiBmYWxzZSwKICAgICAgICAvLyDorr7nva7kuIrkvKDnmoTor7fmsYLlpLTpg6gKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiAiQmVhcmVyICIgKyAoMCwgX2F1dGguZ2V0VG9rZW4pKCkKICAgICAgICB9LAogICAgICAgIC8vIOS4iuS8oOeahOWcsOWdgAogICAgICAgIHVybDogcHJvY2Vzcy5lbnYuVlVFX0FQUF9CQVNFX0FQSSArICIvdnVsbi9zY2FuL2ltcG9ydEFkZHIiLAogICAgICAgIC8vIOS4iuS8oOeahOaWh+S7tuWIl+ihqAogICAgICAgIGZpbGVMaXN0OiBbXQogICAgICB9LAogICAgICBzcmNJUEZsYWc6IGZhbHNlLAogICAgICBkZXNJUEZsYWc6IGZhbHNlLAogICAgICBzY3JpcHRTZWxlY3RSZXF1aXJlZEZsYWc6IHRydWUsCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgc2NyaXB0U2VsZWN0OiBbewogICAgICAgICAgdHlwZTogJ2FycmF5JywKICAgICAgICAgIG1lc3NhZ2U6ICfor7foh7PlsJHpgInmi6nkuIDkuKrmvI/mtJ7miJbogIXlhajpgIknLAogICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgICB9XSwKICAgICAgICAvKnNyY0lQOiBbewogICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgICAgcGF0dGVybjogL14oWzAtOWEtZl17MCw0fTopezd9WzAtOWEtZl17MSw0fSQvLAogICAgICAgICAgbWVzc2FnZTogJ+ivt+i+k+WFpeato+ehrueahElQdjbpnbbmnLrlnLDlnYAnLAogICAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgICAgfV0sKi8KICAgICAgICBkZXNJUDogW3sKICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICAgIHBhdHRlcm46IC9eKFswLTlhLWZdezAsNH06KXs3fVswLTlhLWZdezEsNH0kLywKICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmraPnoa7nmoRJUHY26Z225py65Zyw5Z2AJywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIHNjcmlwdFNlbGVjdE9wdGlvbnM6IFtdLAogICAgICBjb21tYW5kbGlzdDogewogICAgICAgIHV1aWQ6ICIiLAogICAgICAgIG91dHB1dDogIiIsCiAgICAgICAgc2NyaXB0U2VsZWN0OiBbXSwKICAgICAgICBjaGVja2VkOiB0cnVlLAogICAgICAgIHNyY0lQOiAiIiwKICAgICAgICBkZXNJUDogIiIsCiAgICAgICAgdXNlRmlsZTogZmFsc2UsCiAgICAgICAgYWRkckZpbGVOYW1lOiAiIiwKICAgICAgICBzdGFydFBvcnQ6ICIiLAogICAgICAgIGVuZFBvcnQ6ICIiLAogICAgICAgIGRhdGFiYXNlU3dpdGNoOiBmYWxzZSwKICAgICAgICBvc1N3aXRjaDogZmFsc2UsCiAgICAgICAgcmF0ZTogIjAiCiAgICAgIH0sCiAgICAgIHRpbWVvdXQ6IG51bGwKICAgIH07CiAgfSwKICBjb21wdXRlZDoge30sCiAgd2F0Y2g6IHt9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgdGhpcy5jb21tYW5kbGlzdCA9IHt9OwogICAgKDAsIF9zY2FuLmluaXRWdWxuU2NyaXB0KSgpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgIF90aGlzLnNjcmlwdFNlbGVjdE9wdGlvbnMgPSByZXNwb25zZS5kYXRhOwogICAgfSk7CiAgICB0aGlzLmdldENvbW1hbmRzKCk7CiAgICB0aGlzLnRpbWVvdXQgPSBzZXRJbnRlcnZhbCh0aGlzLmdldENvbW1hbmRzLCAzMDAwKTsgLy/ms6jmhI90aGlzLmdldENvbW1hbmRz5LiN5Yqg5ous5Y+3CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkge30sCiAgbWV0aG9kczogewogICAgZ2V0Q29tbWFuZHM6IGZ1bmN0aW9uIGdldENvbW1hbmRzKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKICAgICAgKDAsIF9zY2FuLmdldE9uZ29pbmdDKSgpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UpOwogICAgICAgIF90aGlzMi5jb21tYW5kbGlzdCA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgKDAsIF9zY2FuLmdldE9uZ29pbmdDb20pKCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCJvbmdvaW5nIiArIHJlc3BvbnNlLmRhdGEpOwogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEgPT09IDApIHsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbChfdGhpczIudGltZW91dCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIHN1Ym1pdEZvcm06IGZ1bmN0aW9uIHN1Ym1pdEZvcm0oY21kKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwogICAgICB0aGlzLiRyZWZzWydlbEZvcm0nXS52YWxpZGF0ZShmdW5jdGlvbiAodmFsaWQpIHsKICAgICAgICBpZiAoIXZhbGlkKSByZXR1cm47CiAgICAgICAgLy8gVE9ETyDmj5DkuqTooajljZUKICAgICAgICBpZiAoX3RoaXMzLmZvcm1EYXRhLnVzZUZpbGUpIHsKICAgICAgICAgIF90aGlzMy4kYWxlcnQoIjxkaXYgc3R5bGU9J292ZXJmbG93OiBhdXRvO292ZXJmbG93LXg6IGhpZGRlbjttYXgtaGVpZ2h0OiA3MHZoO3BhZGRpbmc6IDEwcHggMjBweCAwOyc+IiArICLlt7LpgInmi6nnp43lrZDmlofku7bkvZzkuLrovpPlhaUiICsgIjwvZGl2PiIsICLmj5DnpLoiLCB7CiAgICAgICAgICAgIGRhbmdlcm91c2x5VXNlSFRNTFN0cmluZzogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHZhciB1dWlkeCA9IF90aGlzMy51dWlkKDgsIDEwKTsKICAgICAgICBfdGhpczMuY29tbWFuZGxpc3QudW5zaGlmdCh7CiAgICAgICAgICB1dWlkOiB1dWlkeCwKICAgICAgICAgIHNyY0lQOiBfdGhpczMuZm9ybURhdGEuc3JjSVAsCiAgICAgICAgICBkZXNJUDogX3RoaXMzLmZvcm1EYXRhLmRlc0lQLAogICAgICAgICAgc3RhcnRQb3J0OiBfdGhpczMuZm9ybURhdGEuc3RhcnRQb3J0LAogICAgICAgICAgZW5kUG9ydDogX3RoaXMzLmZvcm1EYXRhLmVuZFBvcnQsCiAgICAgICAgICBkYXRhYmFzZVN3aXRjaDogX3RoaXMzLmZvcm1EYXRhLmRhdGFiYXNlU3dpdGNoLAogICAgICAgICAgb3NTd2l0Y2g6IF90aGlzMy5mb3JtRGF0YS5vc1N3aXRjaAogICAgICAgIH0pOwogICAgICAgIF90aGlzMy5mb3JtRGF0YS51dWlkID0gdXVpZHg7CiAgICAgICAgKDAsIF9zY2FuLnNjYW5WdWxuKShfdGhpczMuZm9ybURhdGEpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICB2YXIgX2l0ZXJhdG9yID0gKDAsIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyMi5kZWZhdWx0KShfdGhpczMuY29tbWFuZGxpc3QpLAogICAgICAgICAgICBfc3RlcDsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBfc3RlcC52YWx1ZTsKICAgICAgICAgICAgICBpZiAoaXRlbS51dWlkID09IHJlc3BvbnNlLmRhdGEudXVpZCkgewogICAgICAgICAgICAgICAgaXRlbS5yZXN1bHRzID0gcmVzcG9uc2UuZGF0YS5tc2c7CiAgICAgICAgICAgICAgICBpdGVtLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICBfaXRlcmF0b3IuZShlcnIpOwogICAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgICAgX2l0ZXJhdG9yLmYoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBfdGhpczMudGltZW91dCA9IHNldEludGVydmFsKF90aGlzMy5nZXRDb21tYW5kcywgMzAwMCk7CiAgICAgIH0pOwogICAgfSwKICAgIHJlc2V0Rm9ybTogZnVuY3Rpb24gcmVzZXRGb3JtKCkgewogICAgICB0aGlzLiRyZWZzWydlbEZvcm0nXS5yZXNldEZpZWxkcygpOwogICAgfSwKICAgIGRlbGV0ZVJlY29yZDogZnVuY3Rpb24gZGVsZXRlUmVjb3JkKGNtZCkgewogICAgICAoMCwgX3NjYW4uZGVsQ29tbWFuZCkoY21kLnV1aWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7fSk7CiAgICAgIHRoaXMuZ2V0Q29tbWFuZHMoKTsKICAgIH0sCiAgICAvLyDmlofku7bmj5DkuqTlpITnkIYKICAgIHN1Ym1pdFVwbG9hZDogZnVuY3Rpb24gc3VibWl0VXBsb2FkKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgICAgcmVzb2x2ZShfdGhpczQuJHJlZnMudXBsb2FkLnN1Ym1pdCgpKTsKICAgICAgfSk7CiAgICB9LAogICAgc3VibWl0Rm9ybTE6IGZ1bmN0aW9uIHN1Ym1pdEZvcm0xKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKICAgICAgdGhpcy5zdWJtaXRVcGxvYWQoKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczUuc3VibWl0Rm9ybSgpOwogICAgICB9KTsKICAgIH0sCiAgICBzdG9wVGhyZWFkOiBmdW5jdGlvbiBzdG9wVGhyZWFkKGNtZCkgewogICAgICBpZiAoY21kLnN0YXR1cyA9PT0gIuaaguWBnCIpIHsKICAgICAgICAoMCwgX3NjYW4uc3RvcFRocmVhZCkoY21kLnV1aWQpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoY21kLnN0YXR1cyA9PT0gIue7p+e7rSIpIHsKICAgICAgICAoMCwgX3NjYW4ucmVTdGFydCkoY21kKTsKICAgICAgfQogICAgfSwKICAgIC8vIOaWh+S7tuS4iuS8oOS4reWkhOeQhgogICAgaGFuZGxlRmlsZVVwbG9hZFByb2dyZXNzOiBmdW5jdGlvbiBoYW5kbGVGaWxlVXBsb2FkUHJvZ3Jlc3MoZXZlbnQsIGZpbGUsIGZpbGVMaXN0KSB7CiAgICAgIHRoaXMudXBsb2FkLmlzVXBsb2FkaW5nID0gdHJ1ZTsKICAgIH0sCiAgICAvLyDmlofku7bkuIrkvKDmiJDlip/lpITnkIYKICAgIGhhbmRsZUZpbGVTdWNjZXNzOiBmdW5jdGlvbiBoYW5kbGVGaWxlU3VjY2VzcyhyZXNwb25zZSwgZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgdGhpcy51cGxvYWQuaXNVcGxvYWRpbmcgPSBmYWxzZTsKICAgIH0sCiAgICBoYW5kbGVDaGFuZ2U6IGZ1bmN0aW9uIGhhbmRsZUNoYW5nZShmaWxlLCBmaWxlTGlzdCkgewogICAgICB0aGlzLnNyY0lQRmxhZyA9IHRydWU7CiAgICAgIHRoaXMuZGVzSVBGbGFnID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JtRGF0YS51c2VGaWxlID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JtRGF0YS5hZGRyRmlsZU5hbWUgPSBmaWxlLm5hbWU7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybURhdGEuYWRkckZpbGVOYW1lKTsKICAgIH0sCiAgICBoYW5kbGVSZW1vdmU6IGZ1bmN0aW9uIGhhbmRsZVJlbW92ZShmaWxlLCBmaWxlTGlzdCkgewogICAgICB0aGlzLnNyY0lQRmxhZyA9IGZhbHNlOwogICAgICB0aGlzLmRlc0lQRmxhZyA9IGZhbHNlOwogICAgICB0aGlzLmZvcm1EYXRhLnVzZUZpbGUgPSBmYWxzZTsKICAgIH0sCiAgICB1dWlkOiBmdW5jdGlvbiB1dWlkKGxlbiwgcmFkaXgpIHsKICAgICAgdmFyIGNoYXJzID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6Jy5zcGxpdCgnJyk7CiAgICAgIHZhciB1dWlkID0gW10sCiAgICAgICAgaTsKICAgICAgcmFkaXggPSByYWRpeCB8fCBjaGFycy5sZW5ndGg7CiAgICAgIGlmIChsZW4pIHsKICAgICAgICAvLyBDb21wYWN0IGZvcm0KICAgICAgICBmb3IgKGkgPSAwOyBpIDwgbGVuOyBpKyspIHV1aWRbaV0gPSBjaGFyc1swIHwgTWF0aC5yYW5kb20oKSAqIHJhZGl4XTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyByZmM0MTIyLCB2ZXJzaW9uIDQgZm9ybQogICAgICAgIHZhciByOwogICAgICAgIC8vIHJmYzQxMjIgcmVxdWlyZXMgdGhlc2UgY2hhcmFjdGVycwogICAgICAgIHV1aWRbOF0gPSB1dWlkWzEzXSA9IHV1aWRbMThdID0gdXVpZFsyM10gPSAnLSc7CiAgICAgICAgdXVpZFsxNF0gPSAnNCc7CiAgICAgICAgLy8gRmlsbCBpbiByYW5kb20gZGF0YS4gIEF0IGk9PTE5IHNldCB0aGUgaGlnaCBiaXRzIG9mIGNsb2NrIHNlcXVlbmNlIGFzCiAgICAgICAgLy8gcGVyIHJmYzQxMjIsIHNlYy4gNC4xLjUKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgMzY7IGkrKykgewogICAgICAgICAgaWYgKCF1dWlkW2ldKSB7CiAgICAgICAgICAgIHIgPSAwIHwgTWF0aC5yYW5kb20oKSAqIDE2OwogICAgICAgICAgICB1dWlkW2ldID0gY2hhcnNbaSA9PSAxOSA/IHIgJiAweDMgfCAweDggOiByXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHV1aWQuam9pbignJyk7CiAgICB9CiAgfQp9OwpleHBvcnRzLmRlZmF1bHQgPSBfZGVmYXVsdDs="},{"version":3,"names":["_scan","require","_auth","name","components","props","data","formData","uuid","scriptSelect","checked","srcIP","desIP","useFile","addrFileName","startPort","endPort","databaseSwitch","osSwitch","portSwitch","upload","isUploading","headers","Authorization","getToken","url","process","env","VUE_APP_BASE_API","fileList","srcIPFlag","desIPFlag","scriptSelectRequiredFlag","rules","type","message","trigger","required","pattern","scriptSelectOptions","commandlist","output","rate","timeout","computed","watch","created","_this","initVulnScript","then","response","getCommands","setInterval","mounted","methods","_this2","getOngoingC","console","log","getOngoingCom","clearInterval","submitForm","cmd","_this3","$refs","validate","valid","$alert","dangerouslyUseHTMLString","uuidx","unshift","scanVuln","_iterator","_createForOfIteratorHelper2","default","_step","s","n","done","item","value","results","msg","loading","err","e","f","resetForm","resetFields","deleteRecord","delCommand","submitUpload","_this4","Promise","resolve","submit","submitForm1","_this5","stopThread","status","reStart","handleFileUploadProgress","event","file","handleFileSuccess","handleChange","handleRemove","len","radix","chars","split","i","length","Math","random","r","join","exports","_default"],"sources":["src/views/vuln/scan/index.vue"],"sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form ref=\"elForm\" :model=\"formData\" :rules=\"rules\" size=\"medium\" :inline=\"true\" label-width=\"100px\">\n      <el-form-item prop=\"scriptSelect\">\n        <span slot=\"label\">\n            脚本选择\n            <el-tooltip content=\"勾选“全选”后，不需要单独勾选脚本\" placement=\"top\">\n              <i class=\"el-icon-question\"></i>\n            </el-tooltip>\n          </span>\n        <el-select v-model=\"formData.scriptSelect\" placeholder=\"可多选\"  multiple filterable clearable>\n          <el-option v-for=\"item in scriptSelectOptions\" :key=\"item\" :label=\"item\"\n                     :value=\"item\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item>\n        <el-checkbox v-model=\"formData.checked\">全选</el-checkbox>\n      </el-form-item>\n      <br>\n      <el-form-item>\n        <span slot=\"label\">\n            指定端口\n            <el-tooltip content=\"指定端口后，将只进行端口扫描。脚本扫描、数据库探测、操作系统探测都不会进行。\" placement=\"top\">\n              <i class=\"el-icon-question\"></i>\n            </el-tooltip>\n          </span>\n        <el-switch\n          v-model=\"portSwitch\">\n        </el-switch>\n        <el-input v-model=\"formData.startPort\" placeholder=\"起始端口1-65535\" :disabled=\"!portSwitch\" style=\"width: 160px\" clearable>\n        </el-input>-\n        <el-input v-model=\"formData.endPort\" placeholder=\"结束端口1-65535\" :disabled=\"!portSwitch\" style=\"width: 160px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item label=\"探测数据库型号\" label-width=\"110px\">\n        <el-switch\n          v-model=\"formData.databaseSwitch\">\n        </el-switch>\n      </el-form-item>\n      <el-form-item label=\"探测操作系统型号\" label-width=\"130px\">\n        <el-switch\n          v-model=\"formData.osSwitch\">\n        </el-switch>\n      </el-form-item>\n      <br>\n      <el-form-item label=\"起始地址\" prop=\"srcIP\" >\n        <el-input v-model=\"formData.srcIP\" placeholder=\"\" :disabled=\"srcIPFlag\" style=\"width: 350px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item label=\"结束地址\" prop=\"desIP\" >\n        <el-input v-model=\"formData.desIP\" placeholder=\"非必填项\" :disabled=\"desIPFlag\" style=\"width: 350px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item size=\"medium\">\n        <el-button\n          type=\"primary\"\n          @click=\"submitForm1\"\n          v-hasPermi=\"['vuln:scan:scanvuln']\"\n          style=\"background-color: orangered\">\n          扫描\n        </el-button>\n      </el-form-item>\n\n      <el-upload\n        style=\"padding-left: 30px\"\n        ref=\"upload\"\n        :limit=\"1\"\n        name=\"file\"\n        accept=\".txt\"\n        :action=\"upload.url\"\n        :headers=\"upload.headers\"\n        :file-list=\"upload.fileList\"\n        :on-progress=\"handleFileUploadProgress\"\n        :on-success=\"handleFileSuccess\"\n        :on-change=\"handleChange\"\n        :before-remove=\"handleRemove\"\n        :auto-upload=\"false\">\n        <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取地址文件</el-button>\n        <!--<el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" :loading=\"upload.isUploading\" @click=\"submitUpload\">上传到服务器</el-button>-->\n        <div slot=\"tip\" class=\"el-upload__tip\" style=\"font-size: 14px;color: red\">提示：此按钮可选择地址文件作为输入，只能上传txt文件，txt文件每行应只有一个IPv6地址。选择地址文件后，输入框中的“起始地址”和“结束地址”无效！</div>\n      </el-upload>\n    </el-form>\n    <br>\n    <div v-for=\"(cmd,index) in commandlist\" :key=\"index\">\n      <el-card >\n        <div slot=\"header\" class=\"clearfix\">\n          <span>任务标识 {{cmd.uuid}}</span>\n          <el-button style=\"float: right; padding: 3px 0\" type=\"text\" icon=\"el-icon-caret-right\" @click=\"stopThread(cmd)\">\n            {{cmd.status}} </el-button>\n          <el-button style=\"float: right; padding: 3px 0\" type=\"text\" icon=\"el-icon-delete-solid\" @click=\"deleteRecord(cmd)\">删除 </el-button>\n        </div>\n        <!--<div v-html=\"cmd.srcIP - cmd.desIP\" v-loading=\"cmd.loading\">\n        </div>-->\n        <div>\n          起始地址：{{cmd.srcIP}}<br>\n          结束地址：{{cmd.desIP}}<br>\n          文件输入：{{cmd.useFile}}<br>\n          端口号：{{cmd.startPort}}-{{cmd.endPort}}<br>\n          数据库探测：{{cmd.databaseSwitch}}<br>\n          服务探测：true<br>\n          操作系统探测：{{cmd.osSwitch}}<br>\n          探测结果：<br>\n          <div v-html=\"cmd.output\"/>\n          <el-progress :text-inside=\"true\" :stroke-width=\"26\" :percentage=cmd.rate></el-progress>\n        </div>\n      </el-card>\n      <br>\n    </div>\n  </div>\n</template>\n<script>\n  import { initVulnScript, scanVuln,getOngoingC,getOngoingCom,stopThread,delCommand,reStart} from \"@/api/vuln/scan\";\n  import { getToken } from \"@/utils/auth\";\n  export default {\n    name:\"Scan\",\n    components: {},\n    props: [],\n    data() {\n      return {\n        formData: {\n          uuid:\"\",\n          scriptSelect: [],\n          checked: true,\n          srcIP: \"\",\n          desIP: \"\",\n          useFile: false,\n          addrFileName: \"\",\n          startPort:\"\",\n          endPort:\"\",\n          databaseSwitch:false,\n          osSwitch:false,\n        },\n        portSwitch:false,\n\n        // 上传参数\n        upload: {\n          // 是否禁用上传\n          isUploading: false,\n          // 设置上传的请求头部\n          headers: { Authorization: \"Bearer \" + getToken() },\n          // 上传的地址\n          url: process.env.VUE_APP_BASE_API + \"/vuln/scan/importAddr\",\n          // 上传的文件列表\n          fileList: []\n        },\n        srcIPFlag: false,\n        desIPFlag: false,\n        scriptSelectRequiredFlag: true,\n        rules: {\n          scriptSelect: [{\n            type: 'array',\n            message: '请至少选择一个漏洞或者全选',\n            trigger: 'change'\n          }],\n          /*srcIP: [{\n            required: false,\n            pattern: /^([0-9a-f]{0,4}:){7}[0-9a-f]{1,4}$/,\n            message: '请输入正确的IPv6靶机地址',\n            trigger: 'blur'\n          }],*/\n          desIP: [{\n            required: false,\n            pattern: /^([0-9a-f]{0,4}:){7}[0-9a-f]{1,4}$/,\n            message: '请输入正确的IPv6靶机地址',\n            trigger: 'blur'\n          }],\n        },\n        scriptSelectOptions: [],\n        commandlist: {\n          uuid:\"\",\n          output:\"\",\n          scriptSelect: [],\n          checked: true,\n          srcIP: \"\",\n          desIP: \"\",\n          useFile: false,\n          addrFileName: \"\",\n          startPort:\"\",\n          endPort:\"\",\n          databaseSwitch:false,\n          osSwitch:false,\n          rate:\"0\",\n        },\n        timeout:null,\n      }\n    },\n    computed: {},\n    watch: {},\n    created() {\n      this.commandlist = {};\n      initVulnScript().then(response => {\n        this.scriptSelectOptions = response.data;\n      });\n      this.getCommands();\n      this.timeout = setInterval(this.getCommands,3000);//注意this.getCommands不加括号\n    },\n    mounted() {},\n    methods: {\n      getCommands(){\n        getOngoingC().then(response => {\n          console.log(response);\n          this.commandlist = response.data;\n          getOngoingCom().then(response => {\n            console.log(\"ongoing\"+response.data);\n            if(response.data === 0){\n              clearInterval(this.timeout);\n            }\n          })\n        });\n\n      },\n      submitForm(cmd) {\n        this.$refs['elForm'].validate(valid => {\n          if (!valid) return\n          // TODO 提交表单\n          if(this.formData.useFile){\n            this.$alert(\"<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>\" + \"已选择种子文件作为输入\"  + \"</div>\", \"提示\", { dangerouslyUseHTMLString: true });\n          }\n          var uuidx = this.uuid(8,10);\n          this.commandlist.unshift({\n            uuid: uuidx,\n            srcIP: this.formData.srcIP,\n            desIP: this.formData.desIP,\n            startPort:this.formData.startPort,\n            endPort:this.formData.endPort,\n            databaseSwitch:this.formData.databaseSwitch,\n            osSwitch:this.formData.osSwitch,\n          })\n          this.formData.uuid = uuidx;\n          scanVuln(this.formData).then(response => {\n            for(let item of this.commandlist){\n              if(item.uuid == response.data.uuid){\n                item.results = response.data.msg;\n                item.loading = false;\n              }\n            }\n          })\n          this.timeout = setInterval(this.getCommands,3000);\n        });\n      },\n      resetForm() {\n        this.$refs['elForm'].resetFields()\n      },\n      deleteRecord(cmd) {\n        delCommand(cmd.uuid).then(response =>{\n        });\n        this.getCommands();\n      },\n      // 文件提交处理\n      submitUpload() {\n        return new Promise((resolve)=>{\n          resolve(\n            this.$refs.upload.submit()\n          );\n        })\n      },\n      submitForm1(){\n        this.submitUpload().then(()=>{\n          this.submitForm();\n        })\n      },\n      stopThread(cmd){\n        if (cmd.status === \"暂停\"){\n          stopThread(cmd.uuid).then(response => {\n            console.log(response);\n          });\n        }else if (cmd.status === \"继续\"){\n          reStart(cmd);\n        }\n\n      },\n      // 文件上传中处理\n      handleFileUploadProgress(event, file, fileList) {\n        this.upload.isUploading = true;\n      },\n      // 文件上传成功处理\n      handleFileSuccess(response, file, fileList) {\n        this.upload.isUploading = false;\n      },\n      handleChange(file, fileList){\n        this.srcIPFlag = true;\n        this.desIPFlag = true;\n        this.formData.useFile = true;\n        this.formData.addrFileName = file.name;\n        console.log(this.formData.addrFileName);\n      },\n      handleRemove(file, fileList){\n        this.srcIPFlag = false;\n        this.desIPFlag = false;\n        this.formData.useFile = false;\n      },\n\n      uuid(len, radix){\n        var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\n        var uuid = [], i;\n        radix = radix || chars.length;\n\n        if (len) {\n          // Compact form\n          for (i = 0; i < len; i++) uuid[i] = chars[0 | Math.random() * radix];\n        } else {\n          // rfc4122, version 4 form\n          var r;\n          // rfc4122 requires these characters\n          uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';\n          uuid[14] = '4';\n          // Fill in random data.  At i==19 set the high bits of clock sequence as\n          // per rfc4122, sec. 4.1.5\n          for (i = 0; i < 36; i++) {\n            if (!uuid[i]) {\n              r = 0 | Math.random() * 16;\n              uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n            }\n          }\n        }\n        return uuid.join('');\n    },\n  }\n\n  }\n\n</script>\n<style>\n  h3 {color: #157a0c}\n</style>\n"],"mappings":"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"}]}