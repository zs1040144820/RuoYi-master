{"remainingRequest":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\src\\views\\vuln\\scan\\index.vue?vue&type=style&index=0&id=7b058a38&lang=css&","dependencies":[{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\src\\views\\vuln\\scan\\index.vue","mtime":1686732510000},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":1687240771299},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1687240774283},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\postcss-loader\\src\\index.js","mtime":1687240771919},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1687240770813},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1687240772826}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgpoMyB7Y29sb3I6ICMxNTdhMGN9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmUA","file":"index.vue","sourceRoot":"src/views/vuln/scan","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form ref=\"elForm\" :model=\"formData\" :rules=\"rules\" size=\"medium\" :inline=\"true\" label-width=\"100px\">\n      <el-form-item prop=\"scriptSelect\">\n        <span slot=\"label\">\n            脚本选择\n            <el-tooltip content=\"勾选“全选”后，不需要单独勾选脚本\" placement=\"top\">\n              <i class=\"el-icon-question\"></i>\n            </el-tooltip>\n          </span>\n        <el-select v-model=\"formData.scriptSelect\" placeholder=\"可多选\"  multiple filterable clearable>\n          <el-option v-for=\"item in scriptSelectOptions\" :key=\"item\" :label=\"item\"\n                     :value=\"item\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item>\n        <el-checkbox v-model=\"formData.checked\">全选</el-checkbox>\n      </el-form-item>\n      <br>\n      <el-form-item>\n        <span slot=\"label\">\n            指定端口\n            <el-tooltip content=\"指定端口后，将只进行端口扫描。脚本扫描、数据库探测、操作系统探测都不会进行。\" placement=\"top\">\n              <i class=\"el-icon-question\"></i>\n            </el-tooltip>\n          </span>\n        <el-switch\n          v-model=\"portSwitch\">\n        </el-switch>\n        <el-input v-model=\"formData.startPort\" placeholder=\"起始端口1-65535\" :disabled=\"!portSwitch\" style=\"width: 160px\" clearable>\n        </el-input>-\n        <el-input v-model=\"formData.endPort\" placeholder=\"结束端口1-65535\" :disabled=\"!portSwitch\" style=\"width: 160px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item label=\"探测数据库型号\" label-width=\"110px\">\n        <el-switch\n          v-model=\"formData.databaseSwitch\">\n        </el-switch>\n      </el-form-item>\n      <el-form-item label=\"探测操作系统型号\" label-width=\"130px\">\n        <el-switch\n          v-model=\"formData.osSwitch\">\n        </el-switch>\n      </el-form-item>\n      <br>\n      <el-form-item label=\"起始地址\" prop=\"srcIP\" >\n        <el-input v-model=\"formData.srcIP\" placeholder=\"\" :disabled=\"srcIPFlag\" style=\"width: 350px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item label=\"结束地址\" prop=\"desIP\" >\n        <el-input v-model=\"formData.desIP\" placeholder=\"非必填项\" :disabled=\"desIPFlag\" style=\"width: 350px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item size=\"medium\">\n        <el-button\n          type=\"primary\"\n          @click=\"submitForm1\"\n          v-hasPermi=\"['vuln:scan:scanvuln']\"\n          style=\"background-color: orangered\">\n          扫描\n        </el-button>\n      </el-form-item>\n\n      <el-upload\n        style=\"padding-left: 30px\"\n        ref=\"upload\"\n        :limit=\"1\"\n        name=\"file\"\n        accept=\".txt\"\n        :action=\"upload.url\"\n        :headers=\"upload.headers\"\n        :file-list=\"upload.fileList\"\n        :on-progress=\"handleFileUploadProgress\"\n        :on-success=\"handleFileSuccess\"\n        :on-change=\"handleChange\"\n        :before-remove=\"handleRemove\"\n        :auto-upload=\"false\">\n        <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取地址文件</el-button>\n        <!--<el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" :loading=\"upload.isUploading\" @click=\"submitUpload\">上传到服务器</el-button>-->\n        <div slot=\"tip\" class=\"el-upload__tip\" style=\"font-size: 14px;color: red\">提示：此按钮可选择地址文件作为输入，只能上传txt文件，txt文件每行应只有一个IPv6地址。选择地址文件后，输入框中的“起始地址”和“结束地址”无效！</div>\n      </el-upload>\n    </el-form>\n    <br>\n    <div v-for=\"(cmd,index) in commandlist\" :key=\"index\">\n      <el-card >\n        <div slot=\"header\" class=\"clearfix\">\n          <span>任务标识 {{cmd.uuid}}</span>\n          <el-button style=\"float: right; padding: 3px 0\" type=\"text\" icon=\"el-icon-caret-right\" @click=\"stopThread(cmd)\">\n            {{cmd.status}} </el-button>\n          <el-button style=\"float: right; padding: 3px 0\" type=\"text\" icon=\"el-icon-delete-solid\" @click=\"deleteRecord(cmd)\">删除 </el-button>\n        </div>\n        <!--<div v-html=\"cmd.srcIP - cmd.desIP\" v-loading=\"cmd.loading\">\n        </div>-->\n        <div>\n          起始地址：{{cmd.srcIP}}<br>\n          结束地址：{{cmd.desIP}}<br>\n          文件输入：{{cmd.useFile}}<br>\n          端口号：{{cmd.startPort}}-{{cmd.endPort}}<br>\n          数据库探测：{{cmd.databaseSwitch}}<br>\n          服务探测：true<br>\n          操作系统探测：{{cmd.osSwitch}}<br>\n          探测结果：<br>\n          <div v-html=\"cmd.output\"/>\n          <el-progress :text-inside=\"true\" :stroke-width=\"26\" :percentage=cmd.rate></el-progress>\n        </div>\n      </el-card>\n      <br>\n    </div>\n  </div>\n</template>\n<script>\n  import { initVulnScript, scanVuln,getOngoingC,getOngoingCom,stopThread,delCommand,reStart} from \"@/api/vuln/scan\";\n  import { getToken } from \"@/utils/auth\";\n  export default {\n    name:\"Scan\",\n    components: {},\n    props: [],\n    data() {\n      return {\n        formData: {\n          uuid:\"\",\n          scriptSelect: [],\n          checked: true,\n          srcIP: \"\",\n          desIP: \"\",\n          useFile: false,\n          addrFileName: \"\",\n          startPort:\"\",\n          endPort:\"\",\n          databaseSwitch:false,\n          osSwitch:false,\n        },\n        portSwitch:false,\n\n        // 上传参数\n        upload: {\n          // 是否禁用上传\n          isUploading: false,\n          // 设置上传的请求头部\n          headers: { Authorization: \"Bearer \" + getToken() },\n          // 上传的地址\n          url: process.env.VUE_APP_BASE_API + \"/vuln/scan/importAddr\",\n          // 上传的文件列表\n          fileList: []\n        },\n        srcIPFlag: false,\n        desIPFlag: false,\n        scriptSelectRequiredFlag: true,\n        rules: {\n          scriptSelect: [{\n            type: 'array',\n            message: '请至少选择一个漏洞或者全选',\n            trigger: 'change'\n          }],\n          /*srcIP: [{\n            required: false,\n            pattern: /^([0-9a-f]{0,4}:){7}[0-9a-f]{1,4}$/,\n            message: '请输入正确的IPv6靶机地址',\n            trigger: 'blur'\n          }],*/\n          desIP: [{\n            required: false,\n            pattern: /^([0-9a-f]{0,4}:){7}[0-9a-f]{1,4}$/,\n            message: '请输入正确的IPv6靶机地址',\n            trigger: 'blur'\n          }],\n        },\n        scriptSelectOptions: [],\n        commandlist: {\n          uuid:\"\",\n          output:\"\",\n          scriptSelect: [],\n          checked: true,\n          srcIP: \"\",\n          desIP: \"\",\n          useFile: false,\n          addrFileName: \"\",\n          startPort:\"\",\n          endPort:\"\",\n          databaseSwitch:false,\n          osSwitch:false,\n          rate:\"0\",\n        },\n        timeout:null,\n      }\n    },\n    computed: {},\n    watch: {},\n    created() {\n      this.commandlist = {};\n      initVulnScript().then(response => {\n        this.scriptSelectOptions = response.data;\n      });\n      this.getCommands();\n      this.timeout = setInterval(this.getCommands,3000);//注意this.getCommands不加括号\n    },\n    mounted() {},\n    methods: {\n      getCommands(){\n        getOngoingC().then(response => {\n          console.log(response);\n          this.commandlist = response.data;\n          getOngoingCom().then(response => {\n            console.log(\"ongoing\"+response.data);\n            if(response.data === 0){\n              clearInterval(this.timeout);\n            }\n          })\n        });\n\n      },\n      submitForm(cmd) {\n        this.$refs['elForm'].validate(valid => {\n          if (!valid) return\n          // TODO 提交表单\n          if(this.formData.useFile){\n            this.$alert(\"<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>\" + \"已选择种子文件作为输入\"  + \"</div>\", \"提示\", { dangerouslyUseHTMLString: true });\n          }\n          var uuidx = this.uuid(8,10);\n          this.commandlist.unshift({\n            uuid: uuidx,\n            srcIP: this.formData.srcIP,\n            desIP: this.formData.desIP,\n            startPort:this.formData.startPort,\n            endPort:this.formData.endPort,\n            databaseSwitch:this.formData.databaseSwitch,\n            osSwitch:this.formData.osSwitch,\n          })\n          this.formData.uuid = uuidx;\n          scanVuln(this.formData).then(response => {\n            for(let item of this.commandlist){\n              if(item.uuid == response.data.uuid){\n                item.results = response.data.msg;\n                item.loading = false;\n              }\n            }\n          })\n          this.timeout = setInterval(this.getCommands,3000);\n        });\n      },\n      resetForm() {\n        this.$refs['elForm'].resetFields()\n      },\n      deleteRecord(cmd) {\n        delCommand(cmd.uuid).then(response =>{\n        });\n        this.getCommands();\n      },\n      // 文件提交处理\n      submitUpload() {\n        return new Promise((resolve)=>{\n          resolve(\n            this.$refs.upload.submit()\n          );\n        })\n      },\n      submitForm1(){\n        this.submitUpload().then(()=>{\n          this.submitForm();\n        })\n      },\n      stopThread(cmd){\n        if (cmd.status === \"暂停\"){\n          stopThread(cmd.uuid).then(response => {\n            console.log(response);\n          });\n        }else if (cmd.status === \"继续\"){\n          reStart(cmd);\n        }\n\n      },\n      // 文件上传中处理\n      handleFileUploadProgress(event, file, fileList) {\n        this.upload.isUploading = true;\n      },\n      // 文件上传成功处理\n      handleFileSuccess(response, file, fileList) {\n        this.upload.isUploading = false;\n      },\n      handleChange(file, fileList){\n        this.srcIPFlag = true;\n        this.desIPFlag = true;\n        this.formData.useFile = true;\n        this.formData.addrFileName = file.name;\n        console.log(this.formData.addrFileName);\n      },\n      handleRemove(file, fileList){\n        this.srcIPFlag = false;\n        this.desIPFlag = false;\n        this.formData.useFile = false;\n      },\n\n      uuid(len, radix){\n        var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\n        var uuid = [], i;\n        radix = radix || chars.length;\n\n        if (len) {\n          // Compact form\n          for (i = 0; i < len; i++) uuid[i] = chars[0 | Math.random() * radix];\n        } else {\n          // rfc4122, version 4 form\n          var r;\n          // rfc4122 requires these characters\n          uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';\n          uuid[14] = '4';\n          // Fill in random data.  At i==19 set the high bits of clock sequence as\n          // per rfc4122, sec. 4.1.5\n          for (i = 0; i < 36; i++) {\n            if (!uuid[i]) {\n              r = 0 | Math.random() * 16;\n              uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n            }\n          }\n        }\n        return uuid.join('');\n    },\n  }\n\n  }\n\n</script>\n<style>\n  h3 {color: #157a0c}\n</style>\n"]}]}