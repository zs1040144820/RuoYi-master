{"remainingRequest":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\src\\views\\vuln\\scan\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\src\\views\\vuln\\scan\\index.vue","mtime":1686732510000},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1687240770813},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\babel-loader\\lib\\index.js","mtime":1687240784151},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1687240770813},{"path":"D:\\SoftwareData\\IntelliJ IDEAData\\RuoYi\\ruoyi-master\\ruoyi-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1687240772826}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGluaXRWdWxuU2NyaXB0LCBzY2FuVnVsbixnZXRPbmdvaW5nQyxnZXRPbmdvaW5nQ29tLHN0b3BUaHJlYWQsZGVsQ29tbWFuZCxyZVN0YXJ0fSBmcm9tICJAL2FwaS92dWxuL3NjYW4iOwppbXBvcnQgeyBnZXRUb2tlbiB9IGZyb20gIkAvdXRpbHMvYXV0aCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiJTY2FuIiwKICBjb21wb25lbnRzOiB7fSwKICBwcm9wczogW10sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZvcm1EYXRhOiB7CiAgICAgICAgdXVpZDoiIiwKICAgICAgICBzY3JpcHRTZWxlY3Q6IFtdLAogICAgICAgIGNoZWNrZWQ6IHRydWUsCiAgICAgICAgc3JjSVA6ICIiLAogICAgICAgIGRlc0lQOiAiIiwKICAgICAgICB1c2VGaWxlOiBmYWxzZSwKICAgICAgICBhZGRyRmlsZU5hbWU6ICIiLAogICAgICAgIHN0YXJ0UG9ydDoiIiwKICAgICAgICBlbmRQb3J0OiIiLAogICAgICAgIGRhdGFiYXNlU3dpdGNoOmZhbHNlLAogICAgICAgIG9zU3dpdGNoOmZhbHNlLAogICAgICB9LAogICAgICBwb3J0U3dpdGNoOmZhbHNlLAoKICAgICAgLy8g5LiK5Lyg5Y+C5pWwCiAgICAgIHVwbG9hZDogewogICAgICAgIC8vIOaYr+WQpuemgeeUqOS4iuS8oAogICAgICAgIGlzVXBsb2FkaW5nOiBmYWxzZSwKICAgICAgICAvLyDorr7nva7kuIrkvKDnmoTor7fmsYLlpLTpg6gKICAgICAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246ICJCZWFyZXIgIiArIGdldFRva2VuKCkgfSwKICAgICAgICAvLyDkuIrkvKDnmoTlnLDlnYAKICAgICAgICB1cmw6IHByb2Nlc3MuZW52LlZVRV9BUFBfQkFTRV9BUEkgKyAiL3Z1bG4vc2Nhbi9pbXBvcnRBZGRyIiwKICAgICAgICAvLyDkuIrkvKDnmoTmlofku7bliJfooagKICAgICAgICBmaWxlTGlzdDogW10KICAgICAgfSwKICAgICAgc3JjSVBGbGFnOiBmYWxzZSwKICAgICAgZGVzSVBGbGFnOiBmYWxzZSwKICAgICAgc2NyaXB0U2VsZWN0UmVxdWlyZWRGbGFnOiB0cnVlLAogICAgICBydWxlczogewogICAgICAgIHNjcmlwdFNlbGVjdDogW3sKICAgICAgICAgIHR5cGU6ICdhcnJheScsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36Iez5bCR6YCJ5oup5LiA5Liq5ryP5rSe5oiW6ICF5YWo6YCJJywKICAgICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgICAgfV0sCiAgICAgICAgLypzcmNJUDogW3sKICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICAgIHBhdHRlcm46IC9eKFswLTlhLWZdezAsNH06KXs3fVswLTlhLWZdezEsNH0kLywKICAgICAgICAgIG1lc3NhZ2U6ICfor7fovpPlhaXmraPnoa7nmoRJUHY26Z225py65Zyw5Z2AJywKICAgICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICAgIH1dLCovCiAgICAgICAgZGVzSVA6IFt7CiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgICBwYXR0ZXJuOiAvXihbMC05YS1mXXswLDR9Oil7N31bMC05YS1mXXsxLDR9JC8sCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5q2j56Gu55qESVB2NumdtuacuuWcsOWdgCcsCiAgICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgICB9XSwKICAgICAgfSwKICAgICAgc2NyaXB0U2VsZWN0T3B0aW9uczogW10sCiAgICAgIGNvbW1hbmRsaXN0OiB7CiAgICAgICAgdXVpZDoiIiwKICAgICAgICBvdXRwdXQ6IiIsCiAgICAgICAgc2NyaXB0U2VsZWN0OiBbXSwKICAgICAgICBjaGVja2VkOiB0cnVlLAogICAgICAgIHNyY0lQOiAiIiwKICAgICAgICBkZXNJUDogIiIsCiAgICAgICAgdXNlRmlsZTogZmFsc2UsCiAgICAgICAgYWRkckZpbGVOYW1lOiAiIiwKICAgICAgICBzdGFydFBvcnQ6IiIsCiAgICAgICAgZW5kUG9ydDoiIiwKICAgICAgICBkYXRhYmFzZVN3aXRjaDpmYWxzZSwKICAgICAgICBvc1N3aXRjaDpmYWxzZSwKICAgICAgICByYXRlOiIwIiwKICAgICAgfSwKICAgICAgdGltZW91dDpudWxsLAogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHt9LAogIHdhdGNoOiB7fSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5jb21tYW5kbGlzdCA9IHt9OwogICAgaW5pdFZ1bG5TY3JpcHQoKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgdGhpcy5zY3JpcHRTZWxlY3RPcHRpb25zID0gcmVzcG9uc2UuZGF0YTsKICAgIH0pOwogICAgdGhpcy5nZXRDb21tYW5kcygpOwogICAgdGhpcy50aW1lb3V0ID0gc2V0SW50ZXJ2YWwodGhpcy5nZXRDb21tYW5kcywzMDAwKTsvL+azqOaEj3RoaXMuZ2V0Q29tbWFuZHPkuI3liqDmi6zlj7cKICB9LAogIG1vdW50ZWQoKSB7fSwKICBtZXRob2RzOiB7CiAgICBnZXRDb21tYW5kcygpewogICAgICBnZXRPbmdvaW5nQygpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICB0aGlzLmNvbW1hbmRsaXN0ID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBnZXRPbmdvaW5nQ29tKCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZygib25nb2luZyIrcmVzcG9uc2UuZGF0YSk7CiAgICAgICAgICBpZihyZXNwb25zZS5kYXRhID09PSAwKXsKICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLnRpbWVvdXQpOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgIH0pOwoKICAgIH0sCiAgICBzdWJtaXRGb3JtKGNtZCkgewogICAgICB0aGlzLiRyZWZzWydlbEZvcm0nXS52YWxpZGF0ZSh2YWxpZCA9PiB7CiAgICAgICAgaWYgKCF2YWxpZCkgcmV0dXJuCiAgICAgICAgLy8gVE9ETyDmj5DkuqTooajljZUKICAgICAgICBpZih0aGlzLmZvcm1EYXRhLnVzZUZpbGUpewogICAgICAgICAgdGhpcy4kYWxlcnQoIjxkaXYgc3R5bGU9J292ZXJmbG93OiBhdXRvO292ZXJmbG93LXg6IGhpZGRlbjttYXgtaGVpZ2h0OiA3MHZoO3BhZGRpbmc6IDEwcHggMjBweCAwOyc+IiArICLlt7LpgInmi6nnp43lrZDmlofku7bkvZzkuLrovpPlhaUiICArICI8L2Rpdj4iLCAi5o+Q56S6IiwgeyBkYW5nZXJvdXNseVVzZUhUTUxTdHJpbmc6IHRydWUgfSk7CiAgICAgICAgfQogICAgICAgIHZhciB1dWlkeCA9IHRoaXMudXVpZCg4LDEwKTsKICAgICAgICB0aGlzLmNvbW1hbmRsaXN0LnVuc2hpZnQoewogICAgICAgICAgdXVpZDogdXVpZHgsCiAgICAgICAgICBzcmNJUDogdGhpcy5mb3JtRGF0YS5zcmNJUCwKICAgICAgICAgIGRlc0lQOiB0aGlzLmZvcm1EYXRhLmRlc0lQLAogICAgICAgICAgc3RhcnRQb3J0OnRoaXMuZm9ybURhdGEuc3RhcnRQb3J0LAogICAgICAgICAgZW5kUG9ydDp0aGlzLmZvcm1EYXRhLmVuZFBvcnQsCiAgICAgICAgICBkYXRhYmFzZVN3aXRjaDp0aGlzLmZvcm1EYXRhLmRhdGFiYXNlU3dpdGNoLAogICAgICAgICAgb3NTd2l0Y2g6dGhpcy5mb3JtRGF0YS5vc1N3aXRjaCwKICAgICAgICB9KQogICAgICAgIHRoaXMuZm9ybURhdGEudXVpZCA9IHV1aWR4OwogICAgICAgIHNjYW5WdWxuKHRoaXMuZm9ybURhdGEpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgZm9yKGxldCBpdGVtIG9mIHRoaXMuY29tbWFuZGxpc3QpewogICAgICAgICAgICBpZihpdGVtLnV1aWQgPT0gcmVzcG9uc2UuZGF0YS51dWlkKXsKICAgICAgICAgICAgICBpdGVtLnJlc3VsdHMgPSByZXNwb25zZS5kYXRhLm1zZzsKICAgICAgICAgICAgICBpdGVtLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgdGhpcy50aW1lb3V0ID0gc2V0SW50ZXJ2YWwodGhpcy5nZXRDb21tYW5kcywzMDAwKTsKICAgICAgfSk7CiAgICB9LAogICAgcmVzZXRGb3JtKCkgewogICAgICB0aGlzLiRyZWZzWydlbEZvcm0nXS5yZXNldEZpZWxkcygpCiAgICB9LAogICAgZGVsZXRlUmVjb3JkKGNtZCkgewogICAgICBkZWxDb21tYW5kKGNtZC51dWlkKS50aGVuKHJlc3BvbnNlID0+ewogICAgICB9KTsKICAgICAgdGhpcy5nZXRDb21tYW5kcygpOwogICAgfSwKICAgIC8vIOaWh+S7tuaPkOS6pOWkhOeQhgogICAgc3VibWl0VXBsb2FkKCkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpPT57CiAgICAgICAgcmVzb2x2ZSgKICAgICAgICAgIHRoaXMuJHJlZnMudXBsb2FkLnN1Ym1pdCgpCiAgICAgICAgKTsKICAgICAgfSkKICAgIH0sCiAgICBzdWJtaXRGb3JtMSgpewogICAgICB0aGlzLnN1Ym1pdFVwbG9hZCgpLnRoZW4oKCk9PnsKICAgICAgICB0aGlzLnN1Ym1pdEZvcm0oKTsKICAgICAgfSkKICAgIH0sCiAgICBzdG9wVGhyZWFkKGNtZCl7CiAgICAgIGlmIChjbWQuc3RhdHVzID09PSAi5pqC5YGcIil7CiAgICAgICAgc3RvcFRocmVhZChjbWQudXVpZCkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7CiAgICAgICAgfSk7CiAgICAgIH1lbHNlIGlmIChjbWQuc3RhdHVzID09PSAi57un57utIil7CiAgICAgICAgcmVTdGFydChjbWQpOwogICAgICB9CgogICAgfSwKICAgIC8vIOaWh+S7tuS4iuS8oOS4reWkhOeQhgogICAgaGFuZGxlRmlsZVVwbG9hZFByb2dyZXNzKGV2ZW50LCBmaWxlLCBmaWxlTGlzdCkgewogICAgICB0aGlzLnVwbG9hZC5pc1VwbG9hZGluZyA9IHRydWU7CiAgICB9LAogICAgLy8g5paH5Lu25LiK5Lyg5oiQ5Yqf5aSE55CGCiAgICBoYW5kbGVGaWxlU3VjY2VzcyhyZXNwb25zZSwgZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgdGhpcy51cGxvYWQuaXNVcGxvYWRpbmcgPSBmYWxzZTsKICAgIH0sCiAgICBoYW5kbGVDaGFuZ2UoZmlsZSwgZmlsZUxpc3QpewogICAgICB0aGlzLnNyY0lQRmxhZyA9IHRydWU7CiAgICAgIHRoaXMuZGVzSVBGbGFnID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JtRGF0YS51c2VGaWxlID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JtRGF0YS5hZGRyRmlsZU5hbWUgPSBmaWxlLm5hbWU7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuZm9ybURhdGEuYWRkckZpbGVOYW1lKTsKICAgIH0sCiAgICBoYW5kbGVSZW1vdmUoZmlsZSwgZmlsZUxpc3QpewogICAgICB0aGlzLnNyY0lQRmxhZyA9IGZhbHNlOwogICAgICB0aGlzLmRlc0lQRmxhZyA9IGZhbHNlOwogICAgICB0aGlzLmZvcm1EYXRhLnVzZUZpbGUgPSBmYWxzZTsKICAgIH0sCgogICAgdXVpZChsZW4sIHJhZGl4KXsKICAgICAgdmFyIGNoYXJzID0gJzAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6Jy5zcGxpdCgnJyk7CiAgICAgIHZhciB1dWlkID0gW10sIGk7CiAgICAgIHJhZGl4ID0gcmFkaXggfHwgY2hhcnMubGVuZ3RoOwoKICAgICAgaWYgKGxlbikgewogICAgICAgIC8vIENvbXBhY3QgZm9ybQogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykgdXVpZFtpXSA9IGNoYXJzWzAgfCBNYXRoLnJhbmRvbSgpICogcmFkaXhdOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIHJmYzQxMjIsIHZlcnNpb24gNCBmb3JtCiAgICAgICAgdmFyIHI7CiAgICAgICAgLy8gcmZjNDEyMiByZXF1aXJlcyB0aGVzZSBjaGFyYWN0ZXJzCiAgICAgICAgdXVpZFs4XSA9IHV1aWRbMTNdID0gdXVpZFsxOF0gPSB1dWlkWzIzXSA9ICctJzsKICAgICAgICB1dWlkWzE0XSA9ICc0JzsKICAgICAgICAvLyBGaWxsIGluIHJhbmRvbSBkYXRhLiAgQXQgaT09MTkgc2V0IHRoZSBoaWdoIGJpdHMgb2YgY2xvY2sgc2VxdWVuY2UgYXMKICAgICAgICAvLyBwZXIgcmZjNDEyMiwgc2VjLiA0LjEuNQogICAgICAgIGZvciAoaSA9IDA7IGkgPCAzNjsgaSsrKSB7CiAgICAgICAgICBpZiAoIXV1aWRbaV0pIHsKICAgICAgICAgICAgciA9IDAgfCBNYXRoLnJhbmRvbSgpICogMTY7CiAgICAgICAgICAgIHV1aWRbaV0gPSBjaGFyc1soaSA9PSAxOSkgPyAociAmIDB4MykgfCAweDggOiByXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHV1aWQuam9pbignJyk7CiAgfSwKfQoKfQoK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"index.vue","sourceRoot":"src/views/vuln/scan","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-form ref=\"elForm\" :model=\"formData\" :rules=\"rules\" size=\"medium\" :inline=\"true\" label-width=\"100px\">\n      <el-form-item prop=\"scriptSelect\">\n        <span slot=\"label\">\n            脚本选择\n            <el-tooltip content=\"勾选“全选”后，不需要单独勾选脚本\" placement=\"top\">\n              <i class=\"el-icon-question\"></i>\n            </el-tooltip>\n          </span>\n        <el-select v-model=\"formData.scriptSelect\" placeholder=\"可多选\"  multiple filterable clearable>\n          <el-option v-for=\"item in scriptSelectOptions\" :key=\"item\" :label=\"item\"\n                     :value=\"item\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item>\n        <el-checkbox v-model=\"formData.checked\">全选</el-checkbox>\n      </el-form-item>\n      <br>\n      <el-form-item>\n        <span slot=\"label\">\n            指定端口\n            <el-tooltip content=\"指定端口后，将只进行端口扫描。脚本扫描、数据库探测、操作系统探测都不会进行。\" placement=\"top\">\n              <i class=\"el-icon-question\"></i>\n            </el-tooltip>\n          </span>\n        <el-switch\n          v-model=\"portSwitch\">\n        </el-switch>\n        <el-input v-model=\"formData.startPort\" placeholder=\"起始端口1-65535\" :disabled=\"!portSwitch\" style=\"width: 160px\" clearable>\n        </el-input>-\n        <el-input v-model=\"formData.endPort\" placeholder=\"结束端口1-65535\" :disabled=\"!portSwitch\" style=\"width: 160px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item label=\"探测数据库型号\" label-width=\"110px\">\n        <el-switch\n          v-model=\"formData.databaseSwitch\">\n        </el-switch>\n      </el-form-item>\n      <el-form-item label=\"探测操作系统型号\" label-width=\"130px\">\n        <el-switch\n          v-model=\"formData.osSwitch\">\n        </el-switch>\n      </el-form-item>\n      <br>\n      <el-form-item label=\"起始地址\" prop=\"srcIP\" >\n        <el-input v-model=\"formData.srcIP\" placeholder=\"\" :disabled=\"srcIPFlag\" style=\"width: 350px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item label=\"结束地址\" prop=\"desIP\" >\n        <el-input v-model=\"formData.desIP\" placeholder=\"非必填项\" :disabled=\"desIPFlag\" style=\"width: 350px\" clearable>\n        </el-input>\n      </el-form-item>\n      <el-form-item size=\"medium\">\n        <el-button\n          type=\"primary\"\n          @click=\"submitForm1\"\n          v-hasPermi=\"['vuln:scan:scanvuln']\"\n          style=\"background-color: orangered\">\n          扫描\n        </el-button>\n      </el-form-item>\n\n      <el-upload\n        style=\"padding-left: 30px\"\n        ref=\"upload\"\n        :limit=\"1\"\n        name=\"file\"\n        accept=\".txt\"\n        :action=\"upload.url\"\n        :headers=\"upload.headers\"\n        :file-list=\"upload.fileList\"\n        :on-progress=\"handleFileUploadProgress\"\n        :on-success=\"handleFileSuccess\"\n        :on-change=\"handleChange\"\n        :before-remove=\"handleRemove\"\n        :auto-upload=\"false\">\n        <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取地址文件</el-button>\n        <!--<el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" :loading=\"upload.isUploading\" @click=\"submitUpload\">上传到服务器</el-button>-->\n        <div slot=\"tip\" class=\"el-upload__tip\" style=\"font-size: 14px;color: red\">提示：此按钮可选择地址文件作为输入，只能上传txt文件，txt文件每行应只有一个IPv6地址。选择地址文件后，输入框中的“起始地址”和“结束地址”无效！</div>\n      </el-upload>\n    </el-form>\n    <br>\n    <div v-for=\"(cmd,index) in commandlist\" :key=\"index\">\n      <el-card >\n        <div slot=\"header\" class=\"clearfix\">\n          <span>任务标识 {{cmd.uuid}}</span>\n          <el-button style=\"float: right; padding: 3px 0\" type=\"text\" icon=\"el-icon-caret-right\" @click=\"stopThread(cmd)\">\n            {{cmd.status}} </el-button>\n          <el-button style=\"float: right; padding: 3px 0\" type=\"text\" icon=\"el-icon-delete-solid\" @click=\"deleteRecord(cmd)\">删除 </el-button>\n        </div>\n        <!--<div v-html=\"cmd.srcIP - cmd.desIP\" v-loading=\"cmd.loading\">\n        </div>-->\n        <div>\n          起始地址：{{cmd.srcIP}}<br>\n          结束地址：{{cmd.desIP}}<br>\n          文件输入：{{cmd.useFile}}<br>\n          端口号：{{cmd.startPort}}-{{cmd.endPort}}<br>\n          数据库探测：{{cmd.databaseSwitch}}<br>\n          服务探测：true<br>\n          操作系统探测：{{cmd.osSwitch}}<br>\n          探测结果：<br>\n          <div v-html=\"cmd.output\"/>\n          <el-progress :text-inside=\"true\" :stroke-width=\"26\" :percentage=cmd.rate></el-progress>\n        </div>\n      </el-card>\n      <br>\n    </div>\n  </div>\n</template>\n<script>\n  import { initVulnScript, scanVuln,getOngoingC,getOngoingCom,stopThread,delCommand,reStart} from \"@/api/vuln/scan\";\n  import { getToken } from \"@/utils/auth\";\n  export default {\n    name:\"Scan\",\n    components: {},\n    props: [],\n    data() {\n      return {\n        formData: {\n          uuid:\"\",\n          scriptSelect: [],\n          checked: true,\n          srcIP: \"\",\n          desIP: \"\",\n          useFile: false,\n          addrFileName: \"\",\n          startPort:\"\",\n          endPort:\"\",\n          databaseSwitch:false,\n          osSwitch:false,\n        },\n        portSwitch:false,\n\n        // 上传参数\n        upload: {\n          // 是否禁用上传\n          isUploading: false,\n          // 设置上传的请求头部\n          headers: { Authorization: \"Bearer \" + getToken() },\n          // 上传的地址\n          url: process.env.VUE_APP_BASE_API + \"/vuln/scan/importAddr\",\n          // 上传的文件列表\n          fileList: []\n        },\n        srcIPFlag: false,\n        desIPFlag: false,\n        scriptSelectRequiredFlag: true,\n        rules: {\n          scriptSelect: [{\n            type: 'array',\n            message: '请至少选择一个漏洞或者全选',\n            trigger: 'change'\n          }],\n          /*srcIP: [{\n            required: false,\n            pattern: /^([0-9a-f]{0,4}:){7}[0-9a-f]{1,4}$/,\n            message: '请输入正确的IPv6靶机地址',\n            trigger: 'blur'\n          }],*/\n          desIP: [{\n            required: false,\n            pattern: /^([0-9a-f]{0,4}:){7}[0-9a-f]{1,4}$/,\n            message: '请输入正确的IPv6靶机地址',\n            trigger: 'blur'\n          }],\n        },\n        scriptSelectOptions: [],\n        commandlist: {\n          uuid:\"\",\n          output:\"\",\n          scriptSelect: [],\n          checked: true,\n          srcIP: \"\",\n          desIP: \"\",\n          useFile: false,\n          addrFileName: \"\",\n          startPort:\"\",\n          endPort:\"\",\n          databaseSwitch:false,\n          osSwitch:false,\n          rate:\"0\",\n        },\n        timeout:null,\n      }\n    },\n    computed: {},\n    watch: {},\n    created() {\n      this.commandlist = {};\n      initVulnScript().then(response => {\n        this.scriptSelectOptions = response.data;\n      });\n      this.getCommands();\n      this.timeout = setInterval(this.getCommands,3000);//注意this.getCommands不加括号\n    },\n    mounted() {},\n    methods: {\n      getCommands(){\n        getOngoingC().then(response => {\n          console.log(response);\n          this.commandlist = response.data;\n          getOngoingCom().then(response => {\n            console.log(\"ongoing\"+response.data);\n            if(response.data === 0){\n              clearInterval(this.timeout);\n            }\n          })\n        });\n\n      },\n      submitForm(cmd) {\n        this.$refs['elForm'].validate(valid => {\n          if (!valid) return\n          // TODO 提交表单\n          if(this.formData.useFile){\n            this.$alert(\"<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>\" + \"已选择种子文件作为输入\"  + \"</div>\", \"提示\", { dangerouslyUseHTMLString: true });\n          }\n          var uuidx = this.uuid(8,10);\n          this.commandlist.unshift({\n            uuid: uuidx,\n            srcIP: this.formData.srcIP,\n            desIP: this.formData.desIP,\n            startPort:this.formData.startPort,\n            endPort:this.formData.endPort,\n            databaseSwitch:this.formData.databaseSwitch,\n            osSwitch:this.formData.osSwitch,\n          })\n          this.formData.uuid = uuidx;\n          scanVuln(this.formData).then(response => {\n            for(let item of this.commandlist){\n              if(item.uuid == response.data.uuid){\n                item.results = response.data.msg;\n                item.loading = false;\n              }\n            }\n          })\n          this.timeout = setInterval(this.getCommands,3000);\n        });\n      },\n      resetForm() {\n        this.$refs['elForm'].resetFields()\n      },\n      deleteRecord(cmd) {\n        delCommand(cmd.uuid).then(response =>{\n        });\n        this.getCommands();\n      },\n      // 文件提交处理\n      submitUpload() {\n        return new Promise((resolve)=>{\n          resolve(\n            this.$refs.upload.submit()\n          );\n        })\n      },\n      submitForm1(){\n        this.submitUpload().then(()=>{\n          this.submitForm();\n        })\n      },\n      stopThread(cmd){\n        if (cmd.status === \"暂停\"){\n          stopThread(cmd.uuid).then(response => {\n            console.log(response);\n          });\n        }else if (cmd.status === \"继续\"){\n          reStart(cmd);\n        }\n\n      },\n      // 文件上传中处理\n      handleFileUploadProgress(event, file, fileList) {\n        this.upload.isUploading = true;\n      },\n      // 文件上传成功处理\n      handleFileSuccess(response, file, fileList) {\n        this.upload.isUploading = false;\n      },\n      handleChange(file, fileList){\n        this.srcIPFlag = true;\n        this.desIPFlag = true;\n        this.formData.useFile = true;\n        this.formData.addrFileName = file.name;\n        console.log(this.formData.addrFileName);\n      },\n      handleRemove(file, fileList){\n        this.srcIPFlag = false;\n        this.desIPFlag = false;\n        this.formData.useFile = false;\n      },\n\n      uuid(len, radix){\n        var chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'.split('');\n        var uuid = [], i;\n        radix = radix || chars.length;\n\n        if (len) {\n          // Compact form\n          for (i = 0; i < len; i++) uuid[i] = chars[0 | Math.random() * radix];\n        } else {\n          // rfc4122, version 4 form\n          var r;\n          // rfc4122 requires these characters\n          uuid[8] = uuid[13] = uuid[18] = uuid[23] = '-';\n          uuid[14] = '4';\n          // Fill in random data.  At i==19 set the high bits of clock sequence as\n          // per rfc4122, sec. 4.1.5\n          for (i = 0; i < 36; i++) {\n            if (!uuid[i]) {\n              r = 0 | Math.random() * 16;\n              uuid[i] = chars[(i == 19) ? (r & 0x3) | 0x8 : r];\n            }\n          }\n        }\n        return uuid.join('');\n    },\n  }\n\n  }\n\n</script>\n<style>\n  h3 {color: #157a0c}\n</style>\n"]}]}