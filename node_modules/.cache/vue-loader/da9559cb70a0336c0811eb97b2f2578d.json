{"remainingRequest":"C:\\Users\\TEL17562024206\\Desktop\\Desktop\\ruoyi-ui-master\\ruoyi-ui-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\TEL17562024206\\Desktop\\Desktop\\ruoyi-ui-master\\ruoyi-ui-master\\src\\views\\collectip\\collect2\\index.vue?vue&type=style&index=0&id=6d1283e3&lang=css&","dependencies":[{"path":"C:\\Users\\TEL17562024206\\Desktop\\Desktop\\ruoyi-ui-master\\ruoyi-ui-master\\src\\views\\collectip\\collect2\\index.vue","mtime":1686732510000},{"path":"C:\\Users\\TEL17562024206\\Desktop\\Desktop\\ruoyi-ui-master\\ruoyi-ui-master\\node_modules\\css-loader\\dist\\cjs.js","mtime":1687240771299},{"path":"C:\\Users\\TEL17562024206\\Desktop\\Desktop\\ruoyi-ui-master\\ruoyi-ui-master\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1687240774283},{"path":"C:\\Users\\TEL17562024206\\Desktop\\Desktop\\ruoyi-ui-master\\ruoyi-ui-master\\node_modules\\postcss-loader\\src\\index.js","mtime":1687240771919},{"path":"C:\\Users\\TEL17562024206\\Desktop\\Desktop\\ruoyi-ui-master\\ruoyi-ui-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1687240770813},{"path":"C:\\Users\\TEL17562024206\\Desktop\\Desktop\\ruoyi-ui-master\\ruoyi-ui-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1687240772826}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaDMge2NvbG9yOiAjMTU3YTBjfQouZWwtZHJvcGRvd24gewogIHZlcnRpY2FsLWFsaWduOiB0b3A7Cn0KLmVsLWRyb3Bkb3duICsgLmVsLWRyb3Bkb3duIHsKICBtYXJnaW4tbGVmdDogMTVweDsKfQouZWwtaWNvbi1hcnJvdy1kb3duIHsKICBmb250LXNpemU6IDEycHg7Cn0KLmNhcmQgc3BhbiA+IHNwYW4xIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiBvcmFuZ2U7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIHBhZGRpbmc6IDJweCA1cHg7CiAgY29sb3I6IGFudGlxdWV3aGl0ZTsKfQouY2FyZCBzcGFuID4gc3BhbjIgewogIGJhY2tncm91bmQtY29sb3I6IG1lZGl1bXNlYWdyZWVuOwogIGJvcmRlci1yYWRpdXM6IDRweDsKICBwYWRkaW5nOiAycHggNXB4OwogIGNvbG9yOiBhbnRpcXVld2hpdGU7Cn0KLmNhcmQgc3BhbiA+IHNwYW4zIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiByZWQ7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIHBhZGRpbmc6IDJweCA1cHg7CiAgY29sb3I6IGFudGlxdWV3aGl0ZTsKfQovKiDosIPmlbQgRWxlbWVudCBVSSDmu5rliqjmnaHlrr3luqYgKi8KLmVsLXNjcm9sbGJhcl9fd3JhcDo6LXdlYmtpdC1zY3JvbGxiYXIgewogIHdpZHRoOiA1cHg7Cn0KCi5lbC1zY3JvbGxiYXJfX3dyYXA6Oi13ZWJraXQtc2Nyb2xsYmFyLXRodW1iIHsKICBib3JkZXItcmFkaXVzOiAwOwp9CgouZWwtc2Nyb2xsYmFyX193cmFwOjotd2Via2l0LXNjcm9sbGJhci10cmFjayB7CiAgYm9yZGVyLXJhZGl1czogMDsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/collectip/collect2","sourcesContent":["<!-- 已有资产的地址收集 -->\n<template>\n  <div class=\"app-container\">\n      <el-form>\n        <el-form-item label=\"填写任务名称\"  label-width=\"120px\">\n          <el-input v-model=\"collectip.filename\" placeholder=\"请输入任务名\" :style=\"{ width: '300px' }\" />\n          <span slot=\"label\">\n              填写任务名称\n              <el-tooltip content=\"用于分辨任务，可重复\" placement=\"top\">\n                <i class=\"el-icon-question\"></i>\n              </el-tooltip>\n          </span>\n        </el-form-item>\n        <el-form-item label=\"设定起始地址\"  label-width=\"120px\">\n          <el-input v-model=\"collectip.collectime\" placeholder=\"起始地址\" :style=\"{ width: '300px' }\" />\n          <span slot=\"label\">\n              设定起始地址\n              <el-tooltip content=\"指定地址区间的起始地址\" placement=\"top\">\n                <i class=\"el-icon-question\"></i>\n              </el-tooltip>\n          </span>\n        </el-form-item>\n        <el-form-item label=\"设定结束地址\"  label-width=\"120px\">\n          <el-input v-model=\"collectip.timetype\" placeholder=\"结束地址\" :style=\"{ width: '300px' }\" />\n          <span slot=\"label\">\n              设定结束地址\n              <el-tooltip content=\"指定地址区间的末尾地址\" placement=\"top\">\n                <i class=\"el-icon-question\"></i>\n              </el-tooltip>\n          </span>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" size=\"small\"  @click=\"startcollect2\"\n                   v-hasPermi=\"['CollectIP:start2']\"\n        >开始收集</el-button>\n      </div>\n      <div slot=\"tip\" class=\"el-upload__tip\" style=\"font-size: 14px;color: red\">提示：系统在给定地址区间内主动探测存活的IPv6地址，可同时运行多个任务</div>\n    <br>\n    <br>\n      <el-card class=\"box-card\" style=\"width:1200px;\" >\n        <div slot=\"header\" class=\"clearfix\">\n      <span style=\"color: white; background-color: dodgerblue; border-radius: 4px; padding: 5px 10px;\">\n        <template>\n          <span1><i class=\"el-icon-collection\"></i> 任务中已经收集到的IPv6地址</span1>\n        </template>\n      </span>\n          <el-button style=\"float: right; padding: 3px 0\" type=\"text\" icon=\"el-icon-download\" @click=\"extractIP\">一键提取</el-button>\n        </div>\n        <el-scrollbar style=\"height: 200px;\">\n        <div v-for=\"(item, index) in ipaddrs\" :key=\"index\" class=\"text item\">\n          {{ item }}\n        </div>\n        </el-scrollbar>\n      </el-card>\n    <br>\n    <br>\n    <el-card v-for=\"item in reverseCollectIPList\" :key=\"item.uniqueID\" style=\"width:1200px\" class=\"card\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span>\n            <template v-if=\"item.tasksituation === '运行中'\">\n              <span1><i class=\"el-icon-loading\"></i> 运行中</span1>\n            </template>\n            <template v-else-if=\"item.tasksituation === '运行完毕'\">\n              <span2><i class=\"el-icon-finished\"></i> 运行完毕</span2>\n            </template>\n            <template v-else-if=\"item.tasksituation === '被终止'\">\n              <span3><i class=\"el-icon-close\"></i> 已终止</span3>\n            </template>\n          {{item.filename}}({{item.startime}})\n        </span>\n        <el-button\n        style=\"float: right;\n        padding: 3px 0\"\n        type=\"text\"\n        icon=\"el-icon-caret-right\"\n        :disabled=\"item.tasksituation === '运行完毕' || item.tasksituation === '被终止'\"\n        @click=\"terminateTask(item)\">终止</el-button>\n        <el-button\n          style=\"float: right;\n          padding: 3px 0\"\n          type=\"text\"\n          icon=\"el-icon-delete-solid\"\n          :disabled=\"item.tasksituation === '运行中'\"\n          @click=\"handleDelete(item)\">删除</el-button>\n      </div>\n      <template>\n        <el-scrollbar style=\"height: 400px;\">\n        任务名称：{{item.filename}}<br>\n        起始地址：{{item.collectime}}<br>\n        结束地址：{{item.timetype}}<br>\n        唯一标识：{{item.uniqueID}}<br>\n        地址来源：{{item.source}}<br>\n        任务状态：{{ item.tasksituation }}<br>\n        回显情况：<br>\n          <div v-for=\"detail in detail2DataListTemp\" :key=\"detail.uid\">\n            <template v-if=\"detail.uid === item.uniqueID\">\n              {{ detail.detail }}:<br>\n              {{ detail.command }}\n            </template>\n          </div>\n        </el-scrollbar>\n        <el-progress style=\"width: 1100px\" :text-inside=\"true\" :stroke-width=\"26\" :percentage=item.rate></el-progress>\n      </template>\n    </el-card>\n\n  </div>\n</template>\n\n<script>\nimport {\n  delTaskInfo,\n  findTask,\n  inserTask2,\n  startCollect2,\n  showCommand2,\n  terminateTask,\n  terminateTask2,\n  showAllRecord2,\n  showCollectList2,\n  showIPAddrs\n} from \"@/api/addrcollect/addrcollect\";\n\nexport default {\n  name: \"CollectIPAddr2\",\n\n  data() {\n    return {\n      showNotReady1: false,\n      showNotReady2: false,\n      detail2DataList: [],\n      ipaddrs: [],\n      detail2DataListTemp: {\n        uid:\"\",\n        detail:\"\",\n        command:\"\",\n      },\n      tempCmd: \"\",\n      timerId: null, //定时器ID\n      // 遮罩层\n      loading: true,\n      // 收集IP地址情况总览表格数据\n      collectIPList: [],\n      // 查询参数\n      queryParams: {\n        filename: null,\n        startime: null,\n        tasksituation: null,\n        source: null,\n      },\n      // 创建Collectip表单——胡雨丰23.4.6\n      collectip: {\n        filename: \"\",\n        collectime: \"\",\n        timetype: \"\",\n      },\n      //计时器\n      interval2:null,\n      interval3:null,\n    };\n  },\n  computed: {\n    reverseCollectIPList(){\n      return this.collectIPList.reverse();\n    }\n  },\n  created() {\n    this.detail2DataListTemp = {};\n    this.getList();\n    this.showAllRecord();\n    this.interval2 = setInterval(this.showAllRecord,2000);\n    this.interval3 = setInterval(this.getList,2000);\n  },\n  beforeDestroy() {\n    // 销毁定时器\n    clearInterval(this.timerId);\n    clearInterval(this.interval2);\n    clearInterval(this.interval3);\n  },\n\n  methods: {\n    /** 查询种子地址文件总览列表 */\n    getList() {\n      this.loading = true;\n      showCollectList2(this.queryParams).then(response => {\n        this.collectIPList = response.rows;\n      });\n      showIPAddrs().then(response => {\n        this.ipaddrs = response.rows;\n        this.loading = false;\n      });\n    },\n    /** 文件名为空错误 */\n    showMessageName() {\n      //this.showmessageName = true;\n      //setTimeout(() => {\n      //this.showmessageName = false;\n      //}, 1700);\n      this.$message.error('操作失败，任务名不能为空');\n    },\n    showMessageAddr() {\n      //this.showmessageAddr = true;\n      //setTimeout(() => {\n      //  this.showmessageAddr = false;\n      //}, 1700);\n      this.$message.error('操作失败，起止地址不能为空');\n    },\n    showMessageAddr2() {\n      //this.showmessageAddr2 = true;\n      //setTimeout(() => {\n      //  this.showmessageAddr2 = false;\n      //}, 1700);\n      this.$message.error('操作失败，输入不是IPv6地址');\n    },\n    /** 从已有资产收集IP地址 */\n    startcollect2() {\n      if (!this.collectip.filename) {\n        this.showMessageName();\n        return;\n      }\n      if (!this.collectip.timetype || !this.collectip.collectime) {\n        this.showMessageAddr();\n        return;\n      }\n      if(!this.isIPv6Address(this.collectip.timetype) || !this.isIPv6Address(this.collectip.collectime)) {\n        this.showMessageAddr2();\n        return;\n      }\n      inserTask2(this.collectip).then( response => {\n        this.getList();\n        console.log(response);\n        startCollect2(this.collectip).then( response => {\n          this.getList();\n          console.log(response);\n        });\n      });\n    },\n    //查验ipv6地址格式\n    isIPv6Address(str) {\n      const pattern = /(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/;\n      var regex = new RegExp(pattern);\n      return regex.test(str);\n    },\n    showAllRecord(){\n      showAllRecord2().then(response => {\n        this.detail2DataListTemp = response.rows;\n      });\n    },\n    getCmd2(taskId){\n      showCommand2(taskId).then(response => {\n        this.detail2DataList = response.rows;\n        console.log(response);\n      });\n    },\n    findTask(row){\n      const taskId = row.uniqueID;\n      findTask(taskId).then(response => {\n        console.log(response.msg)\n        if (response.msg == \"运行中\") {\n          this.taskNotReady(row);\n          return;\n        } else if(response.msg == \"运行完毕\") {\n          this.$router.push('/collectipde');\n        } else if(response.msg == \"被终止\") {\n          this.taskNotReady(row);\n          return;\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n    },\n    terminateTask(row){\n      this.$modal.confirm('是否确认终止该任务？').then(() => {\n        const taskId = row.uniqueID;\n        if(row.source == \"出口流量和交换机\") {\n          terminateTask(taskId).then(response => {\n            this.$modal.msgSuccess(\"终止成功\");\n          });\n        }\n        if(row.source == \"已有资产\") {\n          terminateTask2(taskId).then(response => {\n            this.$modal.msgSuccess(\"终止成功\");\n          });\n        }\n      }).catch(() => {});\n    },\n    /** 删除按钮操作 */\n    handleDelete(row) {\n      const taskId = row.uniqueID || this.ids;\n      this.$modal.confirm('是否确认删除任务信息？').then(() => {\n        if (Array.isArray(taskId)) {\n          // 如果taskId是一个数组，则遍历这个数组，对每个元素执行删除操作\n          taskId.forEach(id => {\n            delTaskInfo(id).then(() => {\n              this.$modal.msgSuccess(\"删除成功\");\n              this.getList();\n            }).catch(() => {});\n          });\n          this.getList();\n        } else {\n          // 如果taskId不是一个数组，则直接执行删除操作\n          delTaskInfo(taskId).then(() => {\n            this.$modal.msgSuccess(\"删除成功\");\n            this.getList();\n          }).catch(() => {});\n          this.getList();\n        }\n      }).catch(() => {});\n    },\n    /** 导出已经收集到的IP地址*/\n    extractIP(){\n      const addrs = this.ipaddrs;\n      const addrstr = addrs.join('\\n');  // 将元素连接成一个字符串，并在元素之间使用换行符连接\n      const blob = new Blob([addrstr], { type: 'text/plain' });  // 创建一个 Blob 对象\n      const link = document.createElement('a');\n      link.href = URL.createObjectURL(blob);\n      link.download = 'IPv6Addrs.txt';  // 指定下载文件的文件名为 data.txt\n      link.click();  // 触发链接点击事件来下载文件\n      URL.revokeObjectURL(link.href);  // 释放 URL 对象\n    }\n  }\n};\n</script>\n<style>\nh3 {color: #157a0c}\n.el-dropdown {\n  vertical-align: top;\n}\n.el-dropdown + .el-dropdown {\n  margin-left: 15px;\n}\n.el-icon-arrow-down {\n  font-size: 12px;\n}\n.card span > span1 {\n  background-color: orange;\n  border-radius: 4px;\n  padding: 2px 5px;\n  color: antiquewhite;\n}\n.card span > span2 {\n  background-color: mediumseagreen;\n  border-radius: 4px;\n  padding: 2px 5px;\n  color: antiquewhite;\n}\n.card span > span3 {\n  background-color: red;\n  border-radius: 4px;\n  padding: 2px 5px;\n  color: antiquewhite;\n}\n/* 调整 Element UI 滚动条宽度 */\n.el-scrollbar__wrap::-webkit-scrollbar {\n  width: 5px;\n}\n\n.el-scrollbar__wrap::-webkit-scrollbar-thumb {\n  border-radius: 0;\n}\n\n.el-scrollbar__wrap::-webkit-scrollbar-track {\n  border-radius: 0;\n}\n</style>\n"]}]}